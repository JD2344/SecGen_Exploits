# Class: apache_spark_rce
# apache_spark_install
#
class apache_spark_rce::install {
  Exec { path => [ '/bin/', '/sbin/' , '/usr/bin/', '/usr/sbin/' ] }

  # Install required packages
  ensure_packages(['openjdk-11-jdk'], { ensure => 'installed'})

  $releasename = 'spark-3.1.2-bin-hadoop3.2.tgz'
  file { "/tmp/${releasename}.tgz":
    ensure => file,
    source => "puppet:///modules/apache_spark_rce/${releasename}.tgz"
  }
  -> exec { 'unpack-spark':
    cwd     => '/tmp',
    command => "unzip ${releasename} -d /var/www/nanocms",
    creates => "/var/www/nanocms/${releasename}"
  }
  -> exec { 'set-perms-nanocms':
    command => 'chmod -R 777 /var/www/nanocms/data/pages /var/www/nanocms/data/areas',
  }
}
