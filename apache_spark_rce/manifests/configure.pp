# Class: apache_spark_rce::configure
#
#
class apache_spark_rce::configure {
  $leaked_filenames = ['flagtest'] ##$secgen_parameters['leaked_filenames']
  $strings_to_leak = ['this is a list of strings that are secrets / flags','another secret'] ##$secgen_parameters['strings_to_leak']

  Exec { path => [ '/bin/', '/sbin/' , '/usr/bin/', '/usr/sbin/' ] }

  # We set the acls flag in the config - This ensures its vulnerable
  file { '/usr/local/spark/conf/spark-defaults.conf':
    ensure  => file,
    content => template('apache_spark_rce//spark-defaults.conf.erb'),
  }

  ::secgen_functions::leak_files { 'spark-flag-leak':
    storage_directory => '~/',
    leaked_filenames  => $leaked_filenames,
    strings_to_leak   => $strings_to_leak,
    owner             => 'root',
    mode              => '0750',
    leaked_from       => 'apache_spark_rce',
  }
}
