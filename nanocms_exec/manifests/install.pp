# Class: nanocms
# Install Process for nanocms
#
class nanocms_exec::install {
  Exec { path => [ '/bin/', '/sbin/' , '/usr/bin/', '/usr/sbin/' ] }

  # check apache2 and php installed
  ensure_packages(['apache2', 'php'], { ensure => 'installed'})
  
  $releasename = 'nanocms_exec'
  file { "/usr/local/src/$releasename.zip":
    ensure => file,
    source => "puppet:///modules/nanocms_exec/$releasename.zip"
  }
  -> exec { 'unpack-nanocms':
    cwd     => '/usr/local/src',
    command => "unzip $releasename -d /var/www",
    creates => "/var/www/$releasename"
  }
  -> exec { 'chown-nanocms':
    command => 'chown www-data. /var/www -R',
  }
}
