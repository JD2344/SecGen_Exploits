# Class: lucee_rce::install
# Install process for lucee can be found at:
# https://docs.lucee.org/guides/installing-lucee/download-and-install.html
class lucee_rce::install {
  Exec { path => [ '/bin/', '/sbin/' , '/usr/bin/', '/usr/sbin/' ] }

  ensure_packages(['openjdk-11-jdk'], { ensure => 'installed'})

  file{ '/usr/local/src/lucee-express-5.3.7.43.zip':
    ensure => file,
    source => 'puppet:///modules/lucee_rce/lucee-express-5.3.7.43.zip'
  }
  -> exec { 'unpack-lucee':
    cwd     => '/usr/local/src/',
    command => 'unzip -n lucee-express-5.3.7.43.zip',
  }
  -> file { '/usr/local/src/logs/':
    ensure => present,
  }
  -> exec { 'giveperms-lucee':
    command => 'chmod -R 777 /usr/local/src/bin/',
  }
  #-> file { '/usr/local/src/lucee-express-5.3.7.43.zip':
  #  ensure => absent
  #}
}
